<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <link rel="icon" type="image/png" sizes="16x16" href="./favicon.ico">
  <link rel="apple-touch-icon" sizes="180x180" href="./images/icons/ic_launcher_180.png">
  <link rel="icon" type="image/png" sizes="32x32" href="./images/icons/ic_launcher_32.png">
  <script type="module">
    // detect iOS Safari
    if (('standalone' in navigator) && (!navigator.standalone)) {
      import('https://unpkg.com/pwacompat');
    }
  </script>
  <script type="text/javascript">window.appVersion = "0.0.7"</script>
  <script type="text/javascript">
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker
        .register('./service-worker.js')
        .then(() => console.log('Service Worker Registered'))
        .catch((err) => console.log('ServiceWorker registration failed:', err));
    }

    const linkManifest = document.createElement("link")
    linkManifest.setAttribute("ref", "manifest")
    linkManifest.setAttribute("href", `./manifest.json?v=${appVersion}`)
    document.head.appendChild(linkManifest);

    const linkCssStyle = document.createElement("link")
    linkCssStyle.setAttribute("rel", "stylesheet")
    linkCssStyle.setAttribute("href", `./css/style.css?v=${appVersion}`)
    document.head.appendChild(linkCssStyle);

    const linkCssSwiper = document.createElement("link")
    linkCssSwiper.setAttribute("rel", "stylesheet")
    linkCssSwiper.setAttribute("href", `./css/swiper-bundle.min.css?v=${appVersion}`)
    document.head.appendChild(linkCssSwiper);

    window.onload = () => {
      const script = document.createElement("script")
      script.setAttribute("type", "module")
      script.setAttribute("src", `./js/main.js?v=${appVersion}`)
      document.body.appendChild(script);
    }

  </script>
  <title>家庭核酸检测亮码</title>
</head>

<body>
  <div class="user-info hidden">
    <div class="members" id="members"></div>
    <div class="user-counts">家庭人数: <span id="userCounts">0</span></div>
    <div class="options">
      <button onclick="toEditFamily()">编辑家庭人员</button>
      <button onclick="getNATResult()">查询核酸结果</button>
    </div>
  </div>
  <div class="swiper hidden">
    <div class="swiper-wrapper"></div>
    <div class="swiper-pagination"></div>
  </div>
  <div class="edit-family hidden">
    <div id="edit-family-form" class="edit-family-form">
      <div class="line1">
        <input class="user-name" placeholder="姓名" type="text" maxlength="10" />
        <input class="user-id" placeholder="身份证" type="text" maxlength="18" />
      </div>
      <div class="line2">
        <label for="userQrCode">点击上传健康码截图</label>
        <input id="userQrCode" type="file" accept="image/*" hidden />
        <button id="addUserButton">添加此人</button>
        <button onclick="window.location.reload()">去亮码</button>
      </div>
      <img class="preview hidden">
    </div>
    <div class="user-list"></div>
  </div>
</body>

</html>